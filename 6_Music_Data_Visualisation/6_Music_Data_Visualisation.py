import pandas as pd
# import seaborn as sns
# import matplotlib.pyplot as plt

data = [{'Title': '我想我会 - 《当我飞奔向你》影视剧片尾曲', 'Artist': '尹露浠', 'Track ID': '4pqH3XBAw1qWi2On2y7wz0', 'Tempo': '130 BPM', 'Key': 'C# Maj', 'Loudness': '-9.67db', 'Time Signature': '4/4', 'Popularity': '57%', 'Energy': '41%', 'Danceability': '63%', 'Positiveness': '24%', 'Speechiness': '3%', 'Liveness': '10%', 'Acousticness': '66%', 'Instrumentalness': '0%'}, {'Title': '轻轻的夏天 - 《当我飞奔向你》影视剧插曲', 'Artist': '尹露浠', 'Track ID': '0XflYu3bJEEb9VDjKFD5xd', 'Tempo': '130 BPM', 'Key': 'G# Maj', 'Loudness': '-12.41db', 'Time Signature': '3/4', 'Popularity': '50%', 'Energy': '25%', 'Danceability': '78%', 'Positiveness': '39%', 'Speechiness': '4%', 'Liveness': '13%', 'Acousticness': '88%', 'Instrumentalness': '0%'}, {'Title': '与你共赴', 'Artist': '很美味', 'Track ID': '0fAPWLzwTGkL1k4YmK5fFR', 'Tempo': '120 BPM', 'Key': 'A Maj', 'Loudness': '-8.75db', 'Time Signature': '4/4', 'Popularity': '49%', 'Energy': '56%', 'Danceability': '75%', 'Positiveness': '69%', 'Speechiness': '3%', 'Liveness': '16%', 'Acousticness': '38%', 'Instrumentalness': '0%'}, {'Title': 'Be Your Light(《偷偷藏不住》电视剧插曲 )', 'Artist': '馬伯騫', 'Track ID': '4PfJJbmGkRT0eGaLtjPqt6', 'Tempo': '92 BPM', 'Key': 'F min', 'Loudness': '-5.9db', 'Time Signature': '4/4', 'Popularity': '59%', 'Energy': '55%', 'Danceability': '67%', 'Positiveness': '63%', 'Speechiness': '3%', 'Liveness': '15%', 'Acousticness': '0%', 'Instrumentalness': '0%'}, {'Title': '你（《时光与他，恰是正好》片头曲）', 'Artist': '付思超', 'Track ID': '5scipmlTvCp5QapwQgXWiK', 'Tempo': '110 BPM', 'Key': 'E Maj', 'Loudness': '-9.64db', 'Time Signature': '4/4', 'Popularity': '0%', 'Energy': '47%', 'Danceability': '76%', 'Positiveness': '66%', 'Speechiness': '3%', 'Liveness': '11%', 'Acousticness': '53%', 'Instrumentalness': '0%'}, {'Title': '褪黑素', 'Artist': '江皓南', 'Track ID': '1BjqQ4UYfV9bOKOvaLxi6n', 'Tempo': '148 BPM', 'Key': 'A# min', 'Loudness': '-10.62db', 'Time Signature': '4/4', 'Popularity': '51%', 'Energy': '35%', 'Danceability': '50%', 'Positiveness': '38%', 'Speechiness': '3%', 'Liveness': '10%', 'Acousticness': '74%', 'Instrumentalness': '0%'}, {'Title': '是你.', 'Artist': '政學zedx', 'Track ID': '3fiXwwPL7cUvD7BqkHdN0J', 'Tempo': '82 BPM', 'Key': 'F Maj', 'Loudness': '-11.77db', 'Time Signature': '4/4', 'Popularity': '55%', 'Energy': '21%', 'Danceability': '63%', 'Positiveness': '71%', 'Speechiness': '3%', 'Liveness': '7%', 'Acousticness': '74%', 'Instrumentalness': '0%'}, {'Title': '没有理由', 'Artist': '杨胖雨, Lambert', 'Track ID': '6HyiR5NsthQQjxZNOnEoV2', 'Tempo': '176 BPM', 'Key': 'D Maj', 'Loudness': '-6.14db', 'Time Signature': '4/4', 'Popularity': '54%', 'Energy': '63%', 'Danceability': '52%', 'Positiveness': '32%', 'Speechiness': '27%', 'Liveness': '50%', 'Acousticness': '51%', 'Instrumentalness': '0%'}, {'Title': '荆棘中孤生的花 - 影视剧《惜花芷》主题曲', 'Artist': '希林娜依•高', 'Track ID': '0a461vZllfrVyU485r3Rb1', 'Tempo': '176 BPM', 'Key': 'G Maj', 'Loudness': '-7.67db', 'Time Signature': '4/4', 'Popularity': '47%', 'Energy': '57%', 'Danceability': '47%', 'Positiveness': '25%', 'Speechiness': '3%', 'Liveness': '9%', 'Acousticness': '12%', 'Instrumentalness': '0%'}, {'Title': '小孩', 'Artist': '罗森涛', 'Track ID': '6kyH1z6IdLo1GH3EcZXHMa', 'Tempo': '124 BPM', 'Key': 'C# Maj', 'Loudness': '-8.32db', 'Time Signature': '3/4', 'Popularity': '63%', 'Energy': '33%', 'Danceability': '86%', 'Positiveness': '38%', 'Speechiness': '6%', 'Liveness': '20%', 'Acousticness': '77%', 'Instrumentalness': '0%'}, {'Title': '迷失幻境', 'Artist': 'IN-K, 王忻辰', 'Track ID': '1UbwQEeBGvmSsJrnfEoaU1', 'Tempo': '116 BPM', 'Key': 'A Maj', 'Loudness': '-11db', 'Time Signature': '4/4', 'Popularity': '60%', 'Energy': '29%', 'Danceability': '69%', 'Positiveness': '63%', 'Speechiness': '3%', 'Liveness': '12%', 'Acousticness': '89%', 'Instrumentalness': '0%'}, {'Title': '0321', 'Artist': 'space x', 'Track ID': '3e0ceoakrA8NNWFPhNDXCp', 'Tempo': '172 BPM', 'Key': 'D Maj', 'Loudness': '-6.49db', 'Time Signature': '4/4', 'Popularity': '59%', 'Energy': '42%', 'Danceability': '66%', 'Positiveness': '7%', 'Speechiness': '4%', 'Liveness': '13%', 'Acousticness': '62%', 'Instrumentalness': '0%'}, {'Title': '祝她越来越好', 'Artist': 'Aioz', 'Track ID': '1XxOAnHNSwETn8jFTLMmVs', 'Tempo': '100 BPM', 'Key': 'A Maj', 'Loudness': '-7.21db', 'Time Signature': '4/4', 'Popularity': '54%', 'Energy': '50%', 'Danceability': '62%', 'Positiveness': '33%', 'Speechiness': '3%', 'Liveness': '12%', 'Acousticness': '88%', 'Instrumentalness': '0%'}, {'Title': '有些', 'Artist': '颜人中', 'Track ID': '3V2v19gDm4rmRkMwcgS4X2', 'Tempo': '126 BPM', 'Key': 'G Maj', 'Loudness': '-7.53db', 'Time Signature': '4/4', 'Popularity': '70%', 'Energy': '54%', 'Danceability': '68%', 'Positiveness': '37%', 'Speechiness': '4%', 'Liveness': '8%', 'Acousticness': '74%', 'Instrumentalness': '0%'}, {'Title': 'Someday', 'Artist': 'Aioz', 'Track ID': '00RYSTsQgiNeIrcqOoS3FU', 'Tempo': '92 BPM', 'Key': 'A# Maj', 'Loudness': '-9.41db', 'Time Signature': '4/4', 'Popularity': '52%', 'Energy': '41%', 'Danceability': '67%', 'Positiveness': '40%', 'Speechiness': '3%', 'Liveness': '10%', 'Acousticness': '21%', 'Instrumentalness': '0%'}, {'Title': '喜欢你 - 说唱版', 'Artist': '斑恩Ben, 思遠AL', 'Track ID': '6CgA1dxzAZ0HO7dMYQgodi', 'Tempo': '128 BPM', 'Key': 'A# Maj', 'Loudness': '-5.24db', 'Time Signature': '4/4', 'Popularity': '51%', 'Energy': '68%', 'Danceability': '74%', 'Positiveness': '66%', 'Speechiness': '5%', 'Liveness': '12%', 'Acousticness': '76%', 'Instrumentalness': '0%'}, {'Title': '假裝沒變過', 'Artist': '颜人中', 'Track ID': '0kWUppVLq3IIvXjq36v8EU', 'Tempo': '136 BPM', 'Key': 'A Maj', 'Loudness': '-8.39db', 'Time Signature': '4/4', 'Popularity': '65%', 'Energy': '40%', 'Danceability': '56%', 'Positiveness': '40%', 'Speechiness': '4%', 'Liveness': '10%', 'Acousticness': '62%', 'Instrumentalness': '0%'}, {'Title': '能遇見，就很不錯了', 'Artist': 'Firdhaus', 'Track ID': '2ASWo8MTESnHQhJhpMSPbF', 'Tempo': '116 BPM', 'Key': 'G Maj', 'Loudness': '-9.59db', 'Time Signature': '4/4', 'Popularity': '64%', 'Energy': '22%', 'Danceability': '47%', 'Positiveness': '37%', 'Speechiness': '3%', 'Liveness': '11%', 'Acousticness': '86%', 'Instrumentalness': '0%'}, {'Title': '爱怎么了', 'Artist': '陈村长', 'Track ID': '0c9gjnRGBRke9VmLaZWmhM', 'Tempo': '130 BPM', 'Key': 'G Maj', 'Loudness': '-6db', 'Time Signature': '4/4', 'Popularity': '70%', 'Energy': '61%', 'Danceability': '57%', 'Positiveness': '44%', 'Speechiness': '3%', 'Liveness': '16%', 'Acousticness': '72%', 'Instrumentalness': '0%'}, {'Title': '这是你期盼的长大吗', 'Artist': 'ZQS', 'Track ID': '3AKYofM0vFekNthGbpjMpN', 'Tempo': '120 BPM', 'Key': 'G# Maj', 'Loudness': '-8.56db', 'Time Signature': '4/4', 'Popularity': '68%', 'Energy': '50%', 'Danceability': '64%', 'Positiveness': '52%', 'Speechiness': '3%', 'Liveness': '13%', 'Acousticness': '68%', 'Instrumentalness': '0%'}, {'Title': '白月光与朱砂痣 - 中英文版', 'Artist': '大籽, 嘿人李逵Noisemakers', 'Track ID': '4ZC1k5x3nAJi9E3esl5yLb', 'Tempo': '90 BPM', 'Key': 'B Maj', 'Loudness': '-8.58db', 'Time Signature': '4/4', 'Popularity': '63%', 'Energy': '65%', 'Danceability': '72%', 'Positiveness': '29%', 'Speechiness': '8%', 'Liveness': '36%', 'Acousticness': '54%', 'Instrumentalness': '0%'}, {'Title': 'Jumping Machine (跳楼机)', 'Artist': 'LBI利比', 'Track ID': '1XZE0InCx3SdCnLpVsPpZl', 'Tempo': '128 BPM', 'Key': 'F# Maj', 'Loudness': '-7.98db', 'Time Signature': '4/4', 'Popularity': '82%', 'Energy': '53%', 'Danceability': '60%', 'Positiveness': '35%', 'Speechiness': '3%', 'Liveness': '17%', 'Acousticness': '66%', 'Instrumentalness': '0%'}, {'Title': '烂片剧情', 'Artist': 'LBI利比', 'Track ID': '488IBZgAqHQmUDjg9kTQYG', 'Tempo': '130 BPM', 'Key': 'F# Maj', 'Loudness': '-8.19db', 'Time Signature': '4/4', 'Popularity': '71%', 'Energy': '48%', 'Danceability': '59%', 'Positiveness': '35%', 'Speechiness': '3%', 'Liveness': '10%', 'Acousticness': '68%', 'Instrumentalness': '0%'}, {'Title': '是你', 'Artist': '梦然', 'Track ID': '7gYKASXibOLyet8JTBJOO2', 'Tempo': '123 BPM', 'Key': 'D Maj', 'Loudness': '-8.21db', 'Time Signature': '4/4', 'Popularity': '68%', 'Energy': '53%', 'Danceability': '69%', 'Positiveness': '15%', 'Speechiness': '3%', 'Liveness': '8%', 'Acousticness': '82%', 'Instrumentalness': '1%'}, {'Title': '像极了', 'Artist': 'Ryan.B', 'Track ID': '0UpHEi794wCm1QMSLV6J4M', 'Tempo': '105 BPM', 'Key': 'A Maj', 'Loudness': '-5.11db', 'Time Signature': '4/4', 'Popularity': '63%', 'Energy': '64%', 'Danceability': '66%', 'Positiveness': '66%', 'Speechiness': '4%', 'Liveness': '8%', 'Acousticness': '7%', 'Instrumentalness': '0%'}]
df = pd.DataFrame(data)

# Clean the data
def clean_percent(x):
    return float(x.strip('%')) / 100 if isinstance(x, str) and '%' in x else x

def clean_bpm(x):
    return float(x.strip(' BPM')) if isinstance(x, str) and 'BPM' in x else x

def clean_db(x):
    return float(x.strip('db')) if isinstance(x, str) and 'db' in x else x

df['Tempo'] = df['Tempo'].apply(clean_bpm)
df['Loudness'] = df['Loudness'].apply(clean_db)
df['Popularity'] = df['Popularity'].apply(clean_percent)
df['Energy'] = df['Energy'].apply(clean_percent)
df['Danceability'] = df['Danceability'].apply(clean_percent)
df['Positiveness'] = df['Positiveness'].apply(clean_percent)
df['Speechiness'] = df['Speechiness'].apply(clean_percent)
df['Liveness'] = df['Liveness'].apply(clean_percent)
df['Acousticness'] = df['Acousticness'].apply(clean_percent)
df['Instrumentalness'] = df['Instrumentalness'].apply(clean_percent)

print(df.describe())
df.to_csv("spotify_musicstax_dataset.csv", index=False, encoding="utf-8-sig")
df[['Tempo', 'Energy', 'Danceability']].hist(figsize=(10, 4))
